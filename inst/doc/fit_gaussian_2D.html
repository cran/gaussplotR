<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Vikram B. Baliga" />

<meta name="date" content="2021-05-02" />

<title>Fitting 2D-Gaussians to Data</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Fitting 2D-Gaussians to Data</h1>
<h4 class="author">Vikram B. Baliga</h4>
<h4 class="date">2021-05-02</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>The function <code>fit_gaussian_2D()</code> can be used fit 2D-Gaussians to data, and has several methods for how the fitting is implemented. This vignette will run you through what these methods mean with worked examples.</p>
<p>We’ll begin by loading <code>gaussplotR</code> and loading the sample data set provided within. The raw data we’d like to use are in columns 1:3, so we’ll shave the data set down to those columns before running through the examples.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gaussplotR)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">## We&#39;ll also use lattice, ggplot2 and metR</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice); <span class="fu">library</span>(ggplot2); <span class="fu">library</span>(metR)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: package &#39;ggplot2&#39; was built under R version 4.0.5</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: package &#39;metR&#39; was built under R version 4.0.5</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Load the sample data set</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gaussplot_sample_data)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="do">## The raw data we&#39;d like to use are in columns 1:3</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>samp_dat <span class="ot">&lt;-</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  gaussplot_sample_data[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<p>It generally helps to plot the data beforehand to get a sense of its overall shape. We’ll simply produce a contour plot.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">levelplot</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  response <span class="sc">~</span> X_values <span class="sc">*</span> Y_values,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> samp_dat,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.regions =</span> <span class="fu">colorRampPalette</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    )(<span class="dv">100</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>), </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">asp =</span> <span class="dv">1</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="the-method-and-constrain_orientation-arguments" class="section level2">
<h2>The <code>method</code> and <code>constrain_orientation</code> arguments</h2>
<div id="method" class="section level3">
<h3><code>method</code></h3>
<p><code>gaussplotR::fit_gaussian_2D()</code> has three main options for its <code>method</code> argument: 1) <code>&quot;elliptical&quot;</code>, 2) <code>&quot;elliptical_log&quot;</code>, or 3) <code>&quot;circular&quot;</code>.</p>
<p>The most generic method (and the default) is <code>method = &quot;elliptical&quot;</code>. This allows the fitted 2D-Gaussian to take an ellipsoid shape. If you would like the best-fitting 2D-Gaussian, this is most likely your best bet.</p>
<p>A slightly-altered method to fit an ellipsoid Gaussian is available in <code>method = &quot;elliptical_log&quot;</code>. This method follows Priebe et al. 2003<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> and is geared towards use with log2-transformed data.</p>
<p>A third option is <code>method = &quot;circular&quot;</code>. This produces a very simple 2D-Gaussian that is constrained to have to have a roughly circular shape (i.e. spread in X- and Y- are roughly equal).</p>
<p>An additional argument, <code>constrain_orientation</code> gives additional control over the orientation of the fitted Gaussian. By default, the <code>constrain_orientation</code> is <code>&quot;unconstrained&quot;</code>, meaning that the best-fit orientation is returned.</p>
</div>
<div id="constrain_orientation" class="section level3">
<h3><code>constrain_orientation</code></h3>
<p>Setting constrain_orientation to a numeric (e.g. <code>constrain_orientation = pi/2</code>) will force the orientation of the Gaussian to the specified value, but this is only available when using <code>method = &quot;elliptical&quot;</code> or <code>method = &quot;elliptical_log&quot;</code></p>
<p>Note that supplying a numeric to <code>constrain_orientation</code> is handled differently by <code>method = &quot;elliptical&quot;</code> vs <code>method = &quot;elliptical_log&quot;</code>. With <code>method = &quot;elliptical&quot;</code>, a <code>theta</code> parameter dictates the rotation, in radians, from the x-axis in the clockwise direction. Thus, using <code>method = &quot;elliptical&quot;, constrain_orientation = pi/2</code> will return parameters for an elliptical 2D-Gaussian that is constrained to a 90-degree (pi/2) orientation. In contrast, the <code>method = &quot;elliptical_log&quot;</code> procedure uses a <code>Q</code> parameter to determine the orientation of the 2D-Gaussian. Setting <code>method = &quot;elliptical_log&quot;, constrain_orientation = 0</code> will result in a diagonally-oriented Gaussian, whereas setting <code>constrain_orientation = -1</code> will result in horizontal orientation. Again, see Priebe et al. 2003 for more details.</p>
</div>
</div>
<div id="example-1-unconstrained-elliptical" class="section level2">
<h2>Example 1: Unconstrained elliptical</h2>
<p>Unconstrained ellipticals are the default option and are generally recommended for most purposes. Here’s an example:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>gauss_fit_ue <span class="ot">&lt;-</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit_gaussian_2D</span>(samp_dat)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>gauss_fit_ue</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model coefficients</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   A_o   Amp theta X_peak Y_peak    a    b</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.83 32.25  3.58  -2.64   2.02 0.91 0.96</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model error stats</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     rss rmse deviance AIC</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  156.23 2.08   156.23 171</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting methods</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          method       amplitude     orientation </span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &quot;elliptical&quot; &quot;unconstrained&quot; &quot;unconstrained&quot;</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(gauss_fit_ue)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $names</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;coefs&quot;             &quot;model&quot;             &quot;model_error_stats&quot;</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4] &quot;fit_method&quot;       </span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $gaussplotR</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;gaussplotR_fit&quot;</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $class</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;list&quot;           &quot;gaussplotR_fit&quot;</span></span></code></pre></div>
<p>Fitting an unconstrained ellipse returns an object (here: <code>gauss_fit_ue</code>) that is a <code>data.frame</code> with one column per fitted parameter. The fitted parameters are: <code>A_o</code> (a constant term), <code>Amp</code> (amplitude), <code>theta</code> (rotation, in radians, from the x-axis in the clockwise direction), <code>X_peak</code> (x-axis peak location), <code>Y_peak</code> (y-axis peak location), <code>a</code> (width of Gaussian along x-axis), and <code>b</code> (width of Gaussian along y-axis).</p>
<p>Note that the <code>data.frame</code> in <code>gauss_fit_ue$fit_method</code> indicates the fitting method and whether amplitude and/or orientation were constrained. This <code>data.frame</code> is used by <code>predict_gaussian_2D()</code> to automatically determine what method (and therefore, identity of parameters) was used and then sample points from that fitted Gaussian.</p>
<p>We can elect to sample more points from the fitted Gaussian by feeding in a grid of x- and y- values on which to predict (via <code>expand.grid()</code>.</p>
<p>Then, the fitted object <code>gauss_fit_ue</code> along with the grid of points can be supplied to <code>predict_gaussian_2D</code> to sample more points from the fit, which can be useful for plotting.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Generate a grid of x- and y- values on which to predict</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand.grid</span>(<span class="at">X_values =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">to =</span> <span class="dv">0</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">Y_values =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Predict the values using predict_gaussian_2D</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>gauss_data_ue <span class="ot">&lt;-</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict_gaussian_2D</span>(</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">fit_object =</span> gauss_fit_ue,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">X_values =</span> grid<span class="sc">$</span>X_values,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y_values =</span> grid<span class="sc">$</span>Y_values,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot via ggplot2 and metR</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_gaussian_2D</span>(gauss_data_ue)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAACglBMVEUAAAAAAAQAADoAAGYAOpAAZrYEAQkKAxAPBBUTBhkWCBwYCSAaCyQcDCcfDSshDS8jDjQmDjgoDjwrDkAuDkQuDkYwDkkyDk0zMzM1DVE3DVU6AAA6ADo6AGY6DFo6Ojo6OpA6ZrY6kNs8DF8/C2NCCmhGC2hKDGhODWhSDmhVD2hZEGhdEWhfEmhgEmhkFGhmAABmADpmAGZmOmZmOpBmZmZmZrZmtv9nFWhrFmhuF2hubo5ubqtujo5ujqtuq8hxGGh1Gmh5G2h6HGh8HGh/HmeDH2eGIGeJImeMI2eObm6Obo6ObquOjo6OjquOq8iOq+SOyOSOyP+QJWeQOgCQOjqQOmaQkGaQtpCQ2/+TJmeWKGWaKmOdK2KhLWCkL16nMV2rM1urbm6rbo6rjm6rjo6rjquryP+r5P+tNFquNFmxNle1OVW2ZgC2Zjq2/9u2//+4OlS7PFG+PlDBQE7EQkvFQkvHQ0rIjm7Ijo7IjqvIq47IyMjI5P/I///LRkfOSEbRSUPUS0HXTT/aTzzbkDrb25Db2//b/7bb/9vb///dUTrdUjreVTngWjjhXTfjYTbkq27kq47kq6vkyI7kyKvkyMjk5Mjk5OTk/+Tk///lZTXmaTTnbTPobzLocDLqdDDseC7tfC3ufyvvgirxhijyiibyiyXzjST1kSH2lR/3mBz5mxj6nhT7og/8pQr8pg38/6T9qRr9riT9/KD+sSz+9JT++Jr/tTT/tmb/uTv/vUH/wUj/w0v/xU7/yI7/yVT/zVr/0WH/1Wb/2Gz/25D/29v/3HL/4Hf/4Xj/5H7/5Kv/5Mj/5OT/6IP/7In/8I7//7b//8j//9v//+T///9n6j+RAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAS3UlEQVR4nO3dh4MdRR0H8B+B2LHHBhZOY49GUU/FHmsQRYxIsGvAi3oaG6IYrKdCbESwxF5jR+ynIraoiO24y//jlqk739/8ZvftvPcuzle5y90cL/c+/GZmd9+8WTpeEg3N+heY9xQgIQVISAESUoCEFCAhBUhIARJSgIQUICEFSEgBElKAhBQgIQVISAESUoCEFCAhBUhIARJSgIQUICEFSEgBElKAhBQgIQVISAESUoCEFCAhBUhIARJSgIQUICEFSEgBElKAhBQgIQVISAESUoCEFCAhBUhIARJSgIQwQFedN91fY36DgW7aXQPdowrNf2YAtHHx1bqC6KTBoVO90DYd2t6GdrQh2tWG6MJI9E/tMv9e+ygzADq8dMPkQJwPdXw0D8V5HKGZA21cds7uJx2ZEIj10TzaJywet//MJVCViStI6l9B+Tg4+524RvMEZNvH8KFu//LLxyB0cIxRR+gEAKIe5eMUD9BpiWAJ6QfbhECJPu2TFXlCoc0OxPj43csvH4+nHZ5PWCDifNzy8XiMhpq5LmniGZELRDs2MxAzfZHrQ27vsg5KxsYanThAzPTlHRzqjtI+Z9uxuj6N0QkGJHQvcsqH3PIhzGOAlBCBIWhTAUV9yCkfj4fVCUposwPFfezkTm7vcnTsGcaJCZTg0/QvPaD4I3PFcsjEVesC+T7bNisQ9ulOXs6cfsiPITpxgHwfYn3IGX0YnZYoFEoHOnb6XuYZcS36+6snH8gDBOuHHB8y9UPu6IN1HCGKVFD194wFpJMLCPt0j37a8oE8ZoDmgZwx2vhsFqBEn87gbDQql6/oOGaTAa3vITr5wPqeherrlfoP9Zcu0LHTLziNaOFY9WGx+f7aTtry0ixAST5kfZryURLk6rREMaBOD+OB1vdsrWBOubL6f2W1oL90gU6rmlao/nDyger7azsXKqMMQCT52Nm9GX58nq+E8YQQkPXhgZq+srZzsRbpfGmAFvWH0/fqH1kZHwgf/ziHz53u1T5tnscKTQS00g5pC3UfqwtJfel1sb32Q/1vVLV0/Ni9xwaK+oTDj1c+romLxQN1e1gEqH66dVZPuaI1sirTBBIPf7zZHfQuNXkdPXrUMSIfiC+gSBfboiTWHnVB9aT1lxGgpouNPYtFDn/IH54J9q5GxkYTcUBBAcUG6aogGpZlqsZn/WUEaG3n1tEH6cjwbI+ebfdyfBBPQyQDuT7CNN+UzWo1ix/XX0aAckzzEpDtX3p4Jls+gCcEEgpozs/FevmQ9onw+EIYyPOZbyDBh1wfOzx3eOwgPSWg+si5zpb4OUcEaOOipxxMAUI+zumpuTTfTF+X+OVjda5tY4gYIDyHbZvJBbPDSzc/P2HxAvQBpxfe8OyWj9VpiRyg9AKaSRfbuOzc42oB1WT9y53eTfcyPNd2QhEgroBOnc0Y9LkXiBUk+ezq+ujJneOJArE+g4H0EXM1tdcH0OpTGtA1lx+/dEkA8k5Qye1gxPqQ8UE8WsgAwQIyVxInBFql9nhnfc/i8ZWt+lMi0E1n73uqbu9dP2B6b33IdC+Hh7xxKA4EC4gDug5HNy9vuaCtoLVHH6iLSX1KBHLbB/no42dyfczkRY7O9VUskQekD6NBAZm/kQeq83MvzXdso+I4dr8rq5O1verTWECpPvuBj+ZQOk2oCyT0MKeAOKBf4QRAq6c0MurTSEADfMzwbHiud0M8kFBAHNAvcQKgLBWUMACB8Yds/+rwGKEukFBAMaD/4gRAOcagdB9y+pedvUIeBMTP8V4BcUD/wQmAmuuNW/WnUYB6+Fzi+7TDD+BRQD0L6NQY0L9xfKD6nyHHQelAaf2r9SGmd2GgzhBNXAFxQP/AEZ7uGEC9fMjxudYvn+aEGgOFPmwHY4H+jpMfiD9DJeBzCPvUNjfWMUQkFJC5UGYXRcSB/oaTHUg+wWB8nNFZ4bShEAiMQHwBcUB/wckN1K9/+fWDeAIgPIVFfDigP+NkBkrrX2oCUz6kfRCPBhpeQBzQn3DyAiWOP8anOTw86vnc2A1FCijFhwP6I870gBLGZ336FfPxgSSfziFQDOgPOFmBoj7uCdggnzgQ68MB/R4nJ1BSB9MnqOSdnrI+gwqo82I3/sV/h5MRqO8Er09PSc1fwfDcHwgWEPMMfouTD6jvBE/26hj55RMeBjlDdG+fk5hn8BucbEDx/hUOQIfI719kdOi66yyRXEDCCH0SB/RrnKkAsQWkLnBYH9IDtPFRl4YJFBCxBRQZoVmgX+DkAkr2sRc49PkX8tFAFNaPOkZM9uGAfoaTCSh5AKKYDxkfBij0iQM1vxzzDH6KkweIHYCAD5E7/jg+Do8HFAxA3XMMNVUyPhzQT3CyAMk+toP547Prc12iD+xg4BTjVN378S/+Y5wZAfk+5B1A040xoPAYOnYSHwxAPNCPcHIA8UeI7BlGsg/oYJR0kcP4cEA/xMkAlDqBYZ++Hax7FVH04YB+gKObzTX6dvn0YvP55NSXfTb2Pfn1ur3vJVYLxPkoID2DpR9C9wL6Po5q9dcq1C+rLi8yFaI+ryys0IL+5lVLG6+7HADBAuJ8plRAHND3cFSr9zph/Yrq+kuY9Xjq4dce87FHv+V8W2HNCrNmAVVqAcXOMJILiHodIkaB6nzXS/Md1eK90lyXUtXliFARGaCPnLFugTZeu6Tbp+qDjoDgEaJ7FQbjfAdHtbprFZrPzbpqVEX64Zdpcdl0sZvPPmjaBw5A3BFQSgeTr7J6lzkx0LdxQAWtmldU0TgEH/7SJ59jluD1nMFo8gEIHwHhAYgH+haOanXHIFsYMaBV2rqyEDZboPQZvnuJIzzFoP4+ePyJAH0TR7U6axXajlWXkTPGBEDVIP043I6AzCogeI2MLyDyx5+EU7DhQN/A0c3tcVCzeKHtaSvMwnIHqC47FshbJq5X+abM8M4lDvcikHgRMdWHA/o6Dv7hSGwXY2a5yACdcggdXiNLO0JM9uGAvoYzGIhtT5rh+XMwLeRfZSVq33oQvI7adwDigb6KMxSoOU6CpyIDfXwghyfsX/oaWa9TVBHoyzhDgRqkx6F2OIOxHQwBuS9jgBcx2GuIaT4c0JdwJgHiZ7F+BdTpYV50/cBrZHgpYryDsUBfxBkK1HQxuIZx8gJyS2nSVwlDHw7o0zhDgfh2qYDSgeyyego6GBig2YvQaUCfwhkG1NQPO0gnrrMzq8QZILgQiHqcgWEfDuiTOMOAYu38y6j+Sby0EKizDihYqin79AP6BM5goGW2ggYVUBeIHJ/gRUJvgE4/QowDfRxnKFB1qlH9DyykJtYnnMJYILM60V9HNskZmAj0YZzhQFec/xY4zQ8rIH81x/XeKilUP8N9OKAP4QwFaq5Jw2me9YkWkAPkroT21iH6B9BDfTigD+IMBVrbyV3Uj4/Q/jvBvKX0eset6233MsfP/vHPBP2LB/oAzlCgepRGY3QAxC+FDt5r4ES/TcNMX94Jhu8D19nxPhzQ+3GGA7WXITEQfq83fqscArLvdTLDD7+Io6cPB/Q+nOFAkQrCHSwdCPgkvhcswYcDehfOUKDoGITfDO/6xIBs93JPL5j3gvX34YDeiTMUiG9PLiDzblTAo84uGB8KfEYAegfOXAGZ98STPrtw56/YQvoePhzQ23F0s32DoVq1MPgdh7HtAvzdJuw2Lu1VVfxueP0Kc+IbDUQfDuhtOKrVWbzQvhgW33kBzl8aKKGAOvsFNEbOnwOf/VGfPv2LB3orjmq1Lxyq15uFdz13dzZz2js+aUDXdniO6u6V0L96+sQWL7zJS/Md1WJfelarFsT3zdc/B8/mw/0Cwg0D9IYuLI+e3s0KDs+n9xWOFKA34qhWu3hBrVoQdl4IKug9l+v2lAJigDwe5/DQP37eQRP5cEBvwAkqqMnyYryCumPQxr6zaqBmfRAegSCQt+mN2ZXMjj7w8Cc2f6VtJIuBXoOjWjtDzvJiv50XNo6826ugsIAw0FG96Zbds4280UfcE7Fv+fBAr8ZRrXbxglq10HfnBQYo8NG7sRqhxsjxcnuXM737WwVM4sMBvQpHN9vFC2rVQs/jIA8oUkAAyJXyNttqywcNz8hnUqBX4uAfjiQfkG4Rt9SEw3OyDwf0CpyxgGw7O8d7QIGQ3enXHZ7R+AzPv9J9OKCX42QDCgvI27S2I2R4DuH+JR0f9vDhgF6GMzsgvS002S3qWx8zPJPtXyP6cEAX4kwfyNtV3I1TPmSHn874M7kPB/RinAxAvk8qkNl0XL6twWQ+HNDzcGYABITI5cGb9o/mwwE9F2d8IDuHdYFMCRHU0bcvsrNXd3gexYcDeg5OJiDrA4AOHXLHZVNX6mc6sxfw6byhaCSgZ+OMD7SDB7JCCim4Lw+h8vFf3xl6fCgBPQtndkBevN5lykee3gf4cEDPxMkDpJ5eAARvfWXuwOf0Lqd7hdv5TubDAT0DZ0pAzo33Ah1NZ3j8OxOO2794oKfjTB+IgM4l3n33wNHPaP2LB3oazrSAnLvqgltbkh184PAMT08H+nBAT8SZAVAQCssnow8H9AScqQFxQmTuX+iWD4Hhp+szMtDjcaYHBIU6N6+msHzGrh8W6JE4WYDap+nfP3b//vDu1ZaH3N6V14cDegTONIH279dDsxqkzTdB+WTz4YAejjMFIFdIgXhfXejxeOXj3E5lNB8O6GE4utm+iNHeI7Pf1hQdIEGI5+neGR4Pz5P5cEAPxVGtdjFH/XJq/fKztDVFHyBGSPctPfiY8unMXmNNX3Ggh+CoVvtC6mrNtLwobU3RDwgJkeXD5bNt/OEnBlTnwV6a76gW/6X46k/S1hRJQK4QdWon4JmWDwf0IBzV6i3mqF92Frem6AlUQ9i4397ldS/JJx/QA3FUq1tB9f152yRvTZEChELUHX2C4Wfc8ScCtB1HtTqLOZo79fYE2rjsLHOHOhdoF8WIqFM91J3cM5QPD/QAHNVqF3MoH2lrCj+Hz9u4WG9ussMT4ouoy2OOfTL7cED3x9HNZnWHs0VXbGsKP5cuNasXmgVUHSAoRBTwhAeH3e41kg8HdB8c/MORwIevdPTyDl0OjpDbz9pB2mkzPN2Dw275jOXDAd0LZxygw0sbF7FArRF1aCSebD4c0D1xxgH659n7ztXtO5AQiuEhMDrn8+GA7o4zDpDbngjk8JjBmfcZY3oXgO6Gkw0oKkSAxyufPMNzFOiuOPmAdhAmIqvjTO3e6JOve0WA7oKTEagZXNie1fXhR5+RfTigO+NkBXKN1CzmtyWMPqP7cEB3whkfqCPUGFH4XWb0ye/DAd0RZwpAKERw9AHDz+g+HNAdcMYH2i4LOToezxTKhwe6PU4GIEnI5fF711R8OKDu362SAygmRD5PvHyy+HBAt8PJArQdDcqBTodnOuXDA90WJw9Q10jN8dt78GTz4YBug5MNqDVCMqppW6x35epeEaBb4+QEYuPrTLV8eKBb4cwASObJ6sMB3RJn6kAdHtC7cnavCNAtcKYMFPBMu3x4oLEyCVCXB5VPdp+5BaKQZyY+MwdCQhTqMOWT32fmQNuIgmOhAGdm5TMPQM2z1wE0PM9UfOYCKB6CPNMpn00AhHWmVT5zD8TwTK185hyI5ZmizxwDcTzTLJ+ZAdkNllgdlme6PjMBcjZYugfFI7WLPzD5A8wCyG6wJP314q83+weYLCHQZ9970NkeZ/bPb+6A/vX5IwXIRtpg6f8+meeAzZ8CJKQACSlAQgSgjYvOeeGR6E9cdZ7wAE85GG23t5Xm8p7YhOG8ayJPBKCbzo23H79pdxzo8FJzV2Q2zm2lcdRRPfv49l0TeSIA3XDW7hfF2jcuvjoOVP0nFozjgO5RPYp610S+xICqY+p/Hon8/VX74aUbIkDNQfnnXsAC1O32ttLcA0QBnHdN5EkMqDqm/szB+r8R2/6Fy87Z/SS+AKoHuOby6AMccW4rjX9AAHLeNZEn0hh01r6nxn8iVkH1A5wdfwDnttJcokDOuybypEzzQgqQkAIkpAAJKUBCCpCQAiQkM9DKYrt7iJPVBfyjc5rMQOvhvTcLkJfV+zYbG6w95sr18w8cO4227F1dqIhWFpt39lcfuJsKzUtyA+mbvrx577Ezjv/1ykpGAdWdb6H6sP7RzL/BhMkNtPLYtke1GHuINFB97+StVQXB/SDmKJmBqrJ5c3v/rjPPPFD/cbkFWq4rqMm8D0l5geoti+qteqosV5PZKtFjK56qbu5bj0G0sII3VpunlOMgIQVISAESUoCEFCAhBUhIARJSgIQUICEFSEgBElKAhBQgIQVISAESUoCEFCAhBUhIARJSgIQUICEFSEgBElKAhBQgIQVISAESUoCEFCAhBUhIARJSgIQUICEFSEgBElKAhBQgIQVISAESUoCEFCAhBUhIARJSgIQUICEFSEgBElKAhBQgIf8Dw6UrMvSeEjYAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="example-2-constrained-elliptical" class="section level2">
<h2>Example 2: Constrained elliptical</h2>
<p>As noted above, the <code>constrain_orientation</code> can be used to dictate the orientation. Please note that this will very likely result in a poorer fit, but may be useful for certain types of analyses.</p>
<p>Here we’ll force the Gaussian to be horizontally-oriented.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>gauss_fit_ce <span class="ot">&lt;-</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit_gaussian_2D</span>(samp_dat, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">constrain_orientation =</span> <span class="dv">0</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>gauss_fit_ce</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model coefficients</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   A_o   Amp theta X_peak Y_peak   a    b</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1.26 24.77     0  -2.53   1.95 1.2 1.33</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model error stats</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     rss rmse deviance    AIC</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  885.83 4.96   885.83 231.47</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting methods</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          method       amplitude     orientation </span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &quot;elliptical&quot; &quot;unconstrained&quot;   &quot;constrained&quot;</span></span></code></pre></div>
<p>We’ll use the same grid of x- and y- points as above</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Predict the values using predict_gaussian_2D</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>gauss_data_ce <span class="ot">&lt;-</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict_gaussian_2D</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">fit_object =</span> gauss_fit_ce,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">X_values =</span> grid<span class="sc">$</span>X_values,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y_values =</span> grid<span class="sc">$</span>Y_values,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot via ggplot2 and metR</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_gaussian_2D</span>(gauss_data_ce)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-3-unconstrained-elliptical_log" class="section level2">
<h2>Example 3: Unconstrained elliptical_log</h2>
<p>This procedure follows the formula used in Priebe et al. 2003 and is geared towards log2-transformed data (which the example data are).</p>
<p>Parameters from this model include: <code>Amp</code> (amplitude), <code>Q</code> (orientation parameter), <code>X_peak</code> (x-axis peak location), <code>Y_peak</code> (y-axis peak location), <code>X_sig</code> (spread along x-axis), and <code>Y_sig</code> (spread along y-axis).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>gauss_fit_uel <span class="ot">&lt;-</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit_gaussian_2D</span>(samp_dat, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">&quot;elliptical_log&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>gauss_fit_uel</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model coefficients</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Amp     Q X_peak Y_peak X_sig Y_sig</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  32.23 -0.19  -2.63   2.01  2.11  1.42</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model error stats</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     rss rmse deviance    AIC</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  169.88 2.17   169.88 172.02</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting methods</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           method        amplitude      orientation </span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &quot;elliptical_log&quot;  &quot;unconstrained&quot;  &quot;unconstrained&quot;</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Predict the values using predict_gaussian_2D</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>gauss_data_uel <span class="ot">&lt;-</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict_gaussian_2D</span>(</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">fit_object =</span> gauss_fit_uel,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">X_values =</span> grid<span class="sc">$</span>X_values,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y_values =</span> grid<span class="sc">$</span>Y_values,</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot via ggplot2 and metR</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_gaussian_2D</span>(gauss_data_uel)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-4-constrained-elliptical_log" class="section level2">
<h2>Example 4: Constrained elliptical_log</h2>
<p>Similar to the above, but here the <code>constrain_orientation</code> can be used to dictate the value of the <code>Q</code> parameter used in Priebe et al. 2003. Setting <code>Q</code> to 0 will result in a diagonally-oriented Gaussian, whereas setting <code>Q</code> to -1 will result in horizontal orientation. <code>Q</code> is a continuous parameter, so values in between may be used as well, such as in this example:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>gauss_fit_cel <span class="ot">&lt;-</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit_gaussian_2D</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>      samp_dat,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">&quot;elliptical_log&quot;</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">constrain_orientation =</span> <span class="sc">-</span><span class="fl">0.66</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>gauss_fit_cel</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model coefficients</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Amp     Q X_peak Y_peak X_sig Y_sig</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  40.37 -0.66   -2.6   2.06  1.85  1.25</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model error stats</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    rss rmse deviance    AIC</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  406.1 3.36    406.1 201.39</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting methods</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           method        amplitude      orientation </span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &quot;elliptical_log&quot;  &quot;unconstrained&quot;    &quot;constrained&quot;</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Predict the values using predict_gaussian_2D</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>gauss_data_cel <span class="ot">&lt;-</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict_gaussian_2D</span>(</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">fit_object =</span> gauss_fit_cel,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">X_values =</span> grid<span class="sc">$</span>X_values,</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y_values =</span> grid<span class="sc">$</span>Y_values,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot via ggplot2 and metR</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_gaussian_2D</span>(gauss_data_cel)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Again, setting the value of <code>Q</code> via <code>constrain_orientation</code> will very likely result in poorer-fitting Gaussians. See the analyses in Priebe et al. 2003 to get a sense of useful applications of this approach. Forcing Q = -0.66 in the above example isn’t all that useful, but goes to show that it can be done.</p>
</div>
<div id="example-5-circular" class="section level2">
<h2>Example 5: Circular</h2>
<p>Using <code>method = &quot;circular&quot;</code> constrains the Gaussian to have a roughly circular shape (i.e. spread in X- and Y- are roughly equal).</p>
<p>If this method is used, the fitted parameters are: <code>Amp</code> (amplitude), <code>X_peak</code> (x-axis peak location), <code>Y_peak</code> (y-axis peak location), <code>X_sig</code> (spread along x-axis), and <code>Y_sig</code>(spread along y-axis).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>gauss_fit_cir <span class="ot">&lt;-</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit_gaussian_2D</span>(samp_dat, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">&quot;circular&quot;</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>gauss_fit_cir</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model coefficients</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Amp X_peak Y_peak X_sig Y_sig</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  23.18  -2.55   1.81  1.32  1.64</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model error stats</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     rss rmse deviance    AIC</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  899.61    5   899.61 230.03</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting methods</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          method       amplitude     orientation </span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      &quot;circular&quot; &quot;unconstrained&quot;              NA</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Predict the values using predict_gaussian_2D</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>gauss_data_cir <span class="ot">&lt;-</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict_gaussian_2D</span>(</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">fit_object =</span> gauss_fit_cir,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">X_values =</span> grid<span class="sc">$</span>X_values,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y_values =</span> grid<span class="sc">$</span>Y_values,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot via ggplot2 and metR</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_gaussian_2D</span>(gauss_data_cir)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>That’s all!</p>
<p>🐢</p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Priebe NJ, Cassanello CR, Lisberger SG. The neural representation of speed in macaque area MT/V5. J Neurosci. 2003 Jul 2;23(13):5650-61. doi: 10.1523/JNEUROSCI.23-13-05650.2003.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
